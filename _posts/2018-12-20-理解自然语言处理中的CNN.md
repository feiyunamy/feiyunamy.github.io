---
title: 理解自然语言处理中的CNN
updated: 2018-12-19 21:08
---
## 开始
本文翻译自[Denny Britz](http://www.wildml.com/about/)的博客[《Understanding Convolutional Neural Networks for NLP》](http://www.wildml.com/2015/11/understanding-convolutional-neural-networks-for-nlp/)，文章对于CNN在NLP领域中的应用讲述深入浅出，引用的很多资料也非常有用。
***
每当我们听到卷积神经网络（CNNs），我们最先想到的应该就是计算机视觉。CNNs的应用是图片分类任务取得巨大突破的主要原因，也是目前大多数计算机视觉系统的核心，比如Facebook的照片自动标记以及自动驾驶等领域。

最近以来，CNNs也被应用到许多自然语言处理方面的问题上，并且已经取得了一些很有趣的成果。在这篇博文中，我将尝试概述CNNs到底是什么，以及它在NLP中是如何使用的。CNNs在计算机视觉领域的应用从直觉上来说更加容易理解，所以我也将从计算机视觉开始讲起，并逐渐延伸到自然语言处理中。
## 卷积是什么？
对我来说最简单的理解卷积的方式是把它想象成作用在一个矩阵上的滑动窗口函数。虽然这样很口语化，但是这种方式很容易清楚的理解它，请看下面的可视化例子：
![](http://deeplearning.stanford.edu/wiki/images/6/6c/Convolution_schematic.gif)
大小为3x3的卷积核进行的卷积操作，[图片来源](http://deeplearning.stanford.edu/wiki/index.php/Feature_extraction_using_convolution)

可以把左边的矩阵想象为一张黑白图片。矩阵中的每个数字对应一个像素，0代表黑色，1代表白色（在灰度图中，像素的值一般是在0~255之间）。滑动的窗口就叫做卷积核、过滤器或者特征检测器。这里我们用了一个3x3大小的过滤器，把它的值与原始矩阵中的值对应相乘，再求和。为了完成完整的卷积操作，我们通过滑动窗口来对矩阵中的每个元素都做上述操作。

你可能想知道，通过上述的卷积操作，到底做了什么？下面是一些直观的例子：

**通过求每个像素与其邻近像素的平均值来对图片进行模糊化处理：**

![](http://docs.gimp.org/en/images/filters/examples/convolution-blur.png)![image](http://docs.gimp.org/en/images/filters/examples/generic-taj-convmatrix-blur.jpg)

**通过求每个像素与其邻近像素之间的差值来检测边缘：**

![](http://docs.gimp.org/en/images/filters/examples/convolution-edge-detect1.png)![](http://docs.gimp.org/en/images/filters/examples/generic-taj-convmatrix-edge-detect.jpg)

[这里GIMP manual](http://docs.gimp.org/en/plug-in-convmatrix.html)还有一些例子。为了对CNN的工作机制有更加深入的理解，我推荐阅读[这篇博客](http://colah.github.io/posts/2014-07-Understanding-Convolutions/)

## 卷积神经网络是什么？

现在你已经懂了卷积是什么。但是，卷积神经网络是什么呢？CNNs基本上就是若干层卷积再加上作用在结果上的[ReLU](https://en.wikipedia.org/wiki/Rectifier_(neural_networks))或者[tanh](https://reference.wolfram.com/language/ref/Tanh.html)等非线性激活函数。在传统的前馈神经网络中，我们将输入层的神经元与下一层输出层的神经元挨个连接起来，这样的神经网络也被称为一个全连接层，或者仿射层。在CNN中，我们并不这么做。取而代之的，我们用卷积遍历输入层来获得输出值。这样的操作就是局部链接，即输入的每个区域连接到输出层中的神经元。每一层用不同的卷积核，通常是成百上千个上面提到的卷积操作，并把它们的结果结合起来。另外还有个东西叫做池化层（subsampling），这个后面会讲到。在训练阶段，CNN可以根据具体任务的不同来自动的学习卷积核的值。例如，在图片分类任务中，CNN的第一层可能会学习如何识别边缘，然后利用第一层识别到的边缘特征在第二层中识别简单的形状，然后利用这些简单的形状来探测更加高级的特征，比如说在更高的层中试着探测面部形状。最后一层是一个可以利用前面提取到的特征的分类器。
![](http://www.wildml.com/wp-content/uploads/2015/11/Screen-Shot-2015-11-07-at-7.26.20-AM.png)